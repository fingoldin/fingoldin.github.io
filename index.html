<!DOCTYPE html>

<head>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script src="/jsPsych/jspsych.js"></script>
<script src="/jsPsych/plugins/jspsych-text.js"></script>
<script src="/jsPsych/plugins/jspsych-html.js"></script>
<script src="/jsPsych/plugins/jspsych-animation.js"></script>
<script src="/jsPsych/plugins/jspsych-number-animation.js"></script>
<script src="/jsPsych/plugins/jspsych-html-animation.js"></script>
<script src="/jsPsych/plugins/jspsych-bar-choose.js"></script>
<script src="/jsPsych/plugins/jspsych-ticket-choose.js"></script>
<script src="/utils/general.js"></script>
<script src="/utils/bar-choose-plugin.js"></script>
<script src="/utils/jquery.transform2d.js"></script>
<link href="/jsPsych/css/jspsych.css" rel="stylesheet" type="text/css"></link>
<link href="/utils/general.css" rel="stylesheet" type="text/css"></link>
<link href="/utils/bar-choose-plugin.css" rel="stylesheet" type="text/css"></link>
<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
<link href="/utils/consent.css" rel="stylesheet" type="text/css"></link>
<link href="/utils/ticket-choose.css" rel="stylesheet" type="text/css"></link>
<link href="/utils/start.css" rel="stylesheet" type="text/css"></link>
<link href="/utils/points.css" rel="stylesheet" type="text/css"></link>

<script type="text/javascript">

var points_counter = {
	p: 0
}

var consent_trial = {
	type: "html",	
	url: "/utils/consent.html",
	cont_btn: "agree2"
}

var instructions_trial = {
	type: "html",
	url: "/utils/instructions.html",
	cont_btn: "continue1"
}

var start_trial = {
	type: "html",
	url: "/utils/start.html",
	cont_btn: "start1"
}

var animdata = [98, 91, 101, 107, 107, 92, 98, 107];//, 109, 108, 101, 101, 104, 89, 101, 96, 100, 97, 106, 97, 96, 96, 98, 96, 106, 101, 105, 98, 96, 95, 101, 97, 97, 95, 102, 89, 103, 95, 108, 95, 97, 101, 111, 106, 107, 106, 101, 100, 109, 107];

var animation_trial = {
	type: "number-animation",
	prices: animdata,
	continue_message: "Next step"
}

var training_trial = {
	type: "bar-choose",
	instructions: "Did you learn enough about the potential prices for your ticket? Letâ€™s see ! Imagine we would show you twenty more ticket prices same as the ones seen before.",
	subtitle: "Please drag the bar or type in the input field to determine the amount of tickets that are in the equivalent price range for this trip. Press continue when you are sure of your answers.",
	categories: ["$85 - $90", "$90 - $95", "$95 - $100", "$100 - $105", "$105 - $110", "$110 - $115"],
	min_val: 0,
	max_val: 20
}

var testing_data = [
[105, 95, 101, 102, 98, 94, 106, 107, 103, 100],
[107, 94, 100, 103, 96, 89, 108, 115, 105, 97],
[105, 97, 102, 103, 99, 95, 108, 110, 104, 100],
[104, 94, 98, 102, 95, 90, 107, 114, 103, 96],
[105, 96, 101, 102, 98, 94, 107, 109, 103, 100],
[92, 93, 96, 99, 104, 95, 106, 100, 110, 111],
[91, 92, 95, 97, 100, 93, 102, 98, 103, 104],
[91, 95, 97, 98, 101, 96, 102, 100, 103, 110],
[94, 96, 99, 100, 103, 97, 105, 101, 108, 112],
[93, 95, 97, 98, 102, 96, 103, 100, 104, 105],
[108, 114, 107, 105, 104, 99, 97, 103, 88, 90],
[106, 108, 105, 104, 101, 95, 94, 100, 92, 93],
[110, 111, 109, 108, 104, 100, 99, 102, 92, 98],
[106, 107, 103, 102, 101, 95, 94, 97, 92, 93],
[102, 112, 101, 100, 99, 96, 95, 97, 91, 92],
[93, 107, 95, 103, 94, 113, 96, 101, 98, 97],
[91, 104, 94, 101, 93, 109, 97, 100, 99, 98],
[89, 103, 91, 102, 90, 104, 94, 101, 100, 98],
[86, 106, 93, 102, 90, 108, 94, 99, 96, 95],
[84, 106, 90, 105, 87, 112, 96, 103, 102, 100],
[102, 101, 98, 96, 100, 97, 99, 94, 88, 95],
[101, 102, 98, 96, 100, 97, 99, 94, 88, 95],
[101, 98, 102, 96, 100, 97, 99, 94, 88, 95],
[101, 98, 96, 102, 100, 97, 99, 94, 88, 95],
[101, 98, 96, 100, 102, 97, 99, 94, 88, 95],
[106, 96, 102, 103, 99, 95, 107, 108, 104, 101],
[108, 95, 101, 104, 97, 90, 109, 116, 106, 98],
[106, 98, 103, 104, 100, 96, 109, 111, 105, 101],
[105, 95, 99, 103, 96, 91, 108, 115, 104, 97],
[106, 97, 102, 103, 99, 95, 108, 110, 104, 101],
[93, 94, 97, 100, 105, 96, 107, 101, 111, 112],
[92, 93, 96, 98, 101, 94, 103, 99, 104, 105],
[92, 96, 98, 99, 102, 97, 103, 101, 104, 111],
[95, 97, 100, 101, 104, 98, 106, 102, 109, 113],
[94, 96, 98, 99, 103, 97, 104, 101, 105, 106],
[109, 115, 108, 106, 105, 100, 98, 104, 89, 91],
[107, 109, 106, 105, 102, 96, 95, 101, 93, 94],
[111, 112, 110, 109, 105, 101, 100, 103, 93, 99],
[107, 108, 104, 103, 102, 96, 95, 98, 93, 94],
[103, 113, 102, 101, 100, 97, 96, 98, 92, 93],
[94, 108, 96, 104, 95, 114, 97, 102, 99, 98],
[92, 105, 95, 102, 94, 110, 98, 101, 100, 99],
[90, 104, 92, 103, 91, 105, 95, 102, 101, 99],
[87, 107, 94, 103, 91, 109, 95, 100, 97, 96],
[85, 107, 91, 106, 88, 113, 97, 104, 103, 101],
[103, 102, 99, 97, 101, 98, 100, 95, 89, 96],
[102, 103, 99, 97, 101, 98, 100, 95, 89, 96],
[102, 99, 103, 97, 101, 98, 100, 95, 89, 96],
[102, 99, 97, 103, 101, 98, 100, 95, 89, 96],
[102, 99, 97, 101, 103, 98, 100, 95, 89, 96]];

var testing_instructions_trial = {
	type: "html",
        url: "/utils/testing.html",
        cont_btn: "testingstart"
}

// Second testing instructions (after example sequence)
var testing_instructions2_trial = {
	type: "html",
	url: "/utils/testing2.html",
	cont_btn: "testingstart"
}

// Second bar graph to see learning
var training2_trial = {
	type: "bar-choose",
        instructions: "Insert new instructions here",
        subtitle: "Please drag the bar or type in the input field to determine the amount of tickets that are in the equivalent price range for this trip. Press continue when you are sure of your answers.",
        categories: ["$85 - $90", "$90 - $95", "$95 - $100", "$100 - $105", "$105 - $110", "$110 - $115"],
        min_val: 0,
        max_val: 20
}

var images = ["https://s-media-cache-ak0.pinimg.com/originals/3d/f3/33/3df333457997359bc72e33b68900aaff.jpg"];

function init()
{
	var timeline = [];

	timeline.push(consent_trial);
        timeline.push(instructions_trial);
        timeline.push(start_trial);
        timeline.push(animation_trial);
        timeline.push(training_trial);
        timeline.push(testing_instructions_trial);

	// example testing sequence
	timeline.push({ type: "ticket-choose",
			prices: [10, 50, 20, 30, 45, 87, 18, 98, 94, 89],
			continue_mesage: "Finish",
			sequence: ""
	});

	timeline.push(testing_instructions2_trial);

	for(var i = 0; i < testing_data.length-1; i++)
	{
        	timeline.push({ type: "ticket-choose",
               	                prices: testing_data[i], 
                       	        continue_message: "Next sequence",
				sequence: "Of sequence <span>" + (i + 1) + "</span> out of <span>" + testing_data.length + "</span>",
			//	points: function() { return points_counter; },
				on_finish: function(data) {
                                	points_counter.p += data.points;
                               		console.log(points_counter.p);
                        		showPoints($("#jspsych-points")[0], points_counter);
				}
		});
	}
	timeline.push({ type: "ticket-choose",
                       	prices: testing_data[testing_data.length-1], 
        		continue_message: "Finish",
			sequence: "Of sequence <span>" + testing_data.length + "</span> out of <span>" + testing_data.length + "</span>",
        		//points: function() { return points_counter; },
			on_finish: function(data) {
                                points_counter.p += data.points;
                                console.log(points_counter.p);
				showPoints($("#jspsych-points")[0], points_counter);
                        }
	});

	timeline.push(training2_trial);

	jsPsych.pluginAPI.preloadImages(images, function() {		
		jsPsych.init({
			timeline: timeline,
			display_element: $("#jspsych-main")
		});
	});
}

</script>

</head>

<body onload="init()">
	<div id="jspsych-points"></div>
	<div id="jspsych-main"></div>
</body>

</html>
